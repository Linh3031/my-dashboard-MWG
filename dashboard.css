/* Version 9.6 - SKNV Capture Layout Fix */
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');

:root {
    /* Contrast Levels */
    --bg-lightness-1: 96%; --header-lightness-1: 95%; --header-text-lightness-1: 20%; --special-header-lightness-1: 90%; --below-target-lightness-1: 95%;
    --bg-lightness-2: 94%; --header-lightness-2: 92%; --header-text-lightness-2: 18%; --special-header-lightness-2: 85%; --below-target-lightness-2: 92%;
    --bg-lightness-3: 92%; --header-lightness-3: 88%; --header-text-lightness-3: 15%; --special-header-lightness-3: 80%; --below-target-lightness-3: 88%;
    
    /* KPI Card Colors - Default */
    --kpi-card-1-bg: #38bdf8; /* sky-400 */
    --kpi-card-2-bg: #34d399; /* emerald-400 */
    --kpi-card-3-bg: #fbbf24; /* amber-400 */
    --kpi-card-4-bg: #2dd4bf; /* teal-400 */
    --kpi-card-5-bg: #a78bfa; /* violet-400 */
    --kpi-card-6-bg: #f472b6; /* pink-400 */
    --kpi-text-color: #ffffff;
}

body { font-family: 'Inter', sans-serif; background-color: #f3f4f6; }
body[data-contrast="1"] { --bg-lightness: var(--bg-lightness-1); --header-lightness: var(--header-lightness-1); --header-text-lightness: var(--header-text-lightness-1); --special-header-lightness: var(--special-header-lightness-1); --below-target-lightness: var(--below-target-lightness-1); }
body[data-contrast="2"] { --bg-lightness: var(--bg-lightness-2); --header-lightness: var(--header-lightness-2); --header-text-lightness: var(--header-text-lightness-2); --special-header-lightness: var(--special-header-lightness-2); --below-target-lightness: var(--below-target-lightness-2); }
body[data-contrast="3"] { --bg-lightness: var(--bg-lightness-3); --header-lightness: var(--header-lightness-3); --header-text-lightness: var(--header-text-lightness-3); --special-header-lightness: var(--special-header-lightness-3); --below-target-lightness: var(--below-target-lightness-3); }

::-webkit-scrollbar { width: 8px; }
::-webkit-scrollbar-track { background: #f1f1f1; }
::-webkit-scrollbar-thumb { background: #888; border-radius: 10px; }
::-webkit-scrollbar-thumb:hover { background: #555; }

/* --- SIDEBAR & MAIN CONTENT --- */
#sidebar { width: 68px; transition: width 0.3s ease-in-out; overflow-x: hidden; }
#sidebar:hover { width: 256px; }
#sidebar.menu-locked:hover { width: 68px; }
.menu-text { transition: opacity 0.2s ease-in-out; opacity: 0; white-space: nowrap; }
#sidebar:hover .menu-text { opacity: 1; transition-delay: 0.1s; }
#sidebar.menu-locked:hover .menu-text { opacity: 0; }
#main-content { transition: margin-left 0.3s ease-in-out; margin-left: 68px; }
#sidebar .nav-link { white-space: nowrap; }

/* --- SETTINGS DRAWERS --- */
.settings-drawer {
    width: 400px;
    max-width: 90vw;
    transform: translateX(-100%);
    transition: transform 0.3s ease-in-out;
}
.settings-drawer.open { transform: translateX(0); }
.close-drawer-btn { font-size: 2rem; line-height: 1; }

/* --- NOTIFICATION & PLACEHOLDERS --- */
#notification { position: fixed; bottom: 20px; right: 20px; padding: 1rem 1.5rem; border-radius: 0.5rem; color: white; z-index: 1000; opacity: 0; transition: opacity 0.5s, transform 0.5s; transform: translateY(100px); }
#notification.show { opacity: 1; transform: translateY(0); }
.notification-success { background-color: #28a745; }
.notification-error { background-color: #dc3545; }
.placeholder-message {
    border: 2px dashed #f59e0b; /* amber-500 */
    background-color: #fffbeb; /* amber-50 */
    color: #b45309; /* amber-700 */
    padding: 2rem;
    border-radius: 0.75rem;
    text-align: center;
    font-weight: 600;
}


/* --- TABS & SORTING --- */
.sub-tab-btn { transition: all 0.2s ease-in-out; border-bottom: 2px solid transparent; }
.sub-tab-btn.active { border-color: #3b82f6; color: #3b82f6; background-color: #eff6ff; }
.sortable { cursor: pointer; position: relative; user-select: none; }
.sort-indicator { display: inline-flex; flex-direction: column; align-items: center; justify-content: center; width: 1em; height: 1em; margin-left: 4px; vertical-align: middle; color: #9ca3af; transition: color 0.2s ease-in-out; }
.sortable .sort-indicator::before { content: '▲'; font-size: 0.8em; line-height: 0.5; opacity: 0.4; }
.sortable .sort-indicator::after { content: '▼'; font-size: 0.8em; line-height: 0.5; opacity: 0.4; }
.sortable:hover .sort-indicator { color: #374151; }
.sortable.sorted-asc .sort-indicator::before { opacity: 1; color: #3b82f6; }
.sortable.sorted-asc .sort-indicator::after { opacity: 0.4; }
.sortable.sorted-desc .sort-indicator::after { opacity: 1; color: #3b82f6; }
.sortable.sorted-desc .sort-indicator::before { opacity: 0.4; }

/* --- TABLE STYLES & DYNAMIC COLORS --- */
.table-bordered { border-collapse: collapse; }
.table-bordered th, .table-bordered td { border: 1px solid #e5e7eb; }
.table-striped tbody tr:nth-child(even) { background-color: #f9fafb; }
.table-footer { background-color: hsl(210, 20%, var(--header-lightness)); border-top: 2px solid #9ca3af; }
.cell-performance.is-below { background-color: hsl(0, 80%, var(--below-target-lightness)); }
.header-bg-blue { background-color: hsl(217, 95%, var(--special-header-lightness)) !important; color: hsl(217, 80%, var(--header-text-lightness)) !important; }
.header-bg-green { background-color: hsl(145, 80%, var(--special-header-lightness)) !important; color: hsl(145, 70%, var(--header-text-lightness)) !important; }
.header-bg-yellow { background-color: hsl(45, 95%, var(--special-header-lightness)) !important; color: hsl(45, 80%, var(--header-text-lightness)) !important; }
.header-group-1 { background-color: hsl(30, 90%, var(--header-lightness)); }
.header-group-2 { background-color: hsl(90, 90%, var(--header-lightness)); }
.header-group-3 { background-color: hsl(180, 90%, var(--header-lightness)); }

/* [*] FIX: Added standard 'line-clamp' property for compatibility */
.line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    line-clamp: 2; /* Standard property */
    -webkit-box-orient: vertical;
    overflow: hidden;
}

/* Department Title Colors */
.department-header-tv { background-color: #e0e7ff; color: #3730a3; } /* indigo */
.department-header-kho { background-color: #d1fae5; color: #065f46; } /* emerald */
.department-header-tt { background-color: #fef3c7; color: #92400e; } /* amber */

/* Category Title Colors */
.category-header-ict { background-color: #dbeafe; color: #1e40af; } /* blue */
.category-header-phukien { background-color: #fee2e2; color: #991b1b; } /* red */
.category-header-giadung { background-color: #fef9c3; color: #854d0e; } /* yellow */
.category-header-ce { background-color: #e0f2fe; color: #0c4a6e; } /* sky */
.category-header-baohiem { background-color: #f3e8ff; color: #6b21a8; } /* purple */

.qdc-group-title { font-weight: 600; }
.qdc-group-ict { background-color: hsl(190, 80%, var(--special-header-lightness)); }
.qdc-group-vas { background-color: hsl(140, 80%, var(--special-header-lightness)); }
.qdc-group-giadung { background-color: hsl(0, 80%, var(--special-header-lightness)); }
.qdc-group-sim { background-color: hsl(40, 80%, var(--special-header-lightness)); }

.competition-header-doanhthu { border-color: #a78bfa; background-color: hsl(260, 90%, var(--bg-lightness)); }
.competition-header-soluong { border-color: #facc15; background-color: hsl(50, 90%, var(--bg-lightness)); }
.header-highlight-special { background-color: hsl(25, 90%, var(--header-lightness)) !important; }

.competition-row-below-100 td {
    background-color: #fee2e2; /* red-100 */
    color: #991b1b; /* red-800 */
}

/* --- KPI CARDS --- */
.kpi-card { color: var(--kpi-text-color); }
.kpi-card p { color: inherit; }
.kpi-card-title { opacity: 0.8; }
.kpi-percentage, .kpi-percentage-value {
    font-weight: 700;
}
.kpi-sub-value {
    opacity: 0.9;
    font-size: 0.9em;
}

#luyke-kpi-cards-container .kpi-card:nth-child(1), #realtime-kpi-cards-container .kpi-card:nth-child(1) { background-color: var(--kpi-card-1-bg); }
#luyke-kpi-cards-container .kpi-card:nth-child(2), #realtime-kpi-cards-container .kpi-card:nth-child(2) { background-color: var(--kpi-card-2-bg); }
#luyke-kpi-cards-container .kpi-card:nth-child(3), #realtime-kpi-cards-container .kpi-card:nth-child(3) { background-color: var(--kpi-card-3-bg); }
#luyke-kpi-cards-container .kpi-card:nth-child(4), #realtime-kpi-cards-container .kpi-card:nth-child(4) { background-color: var(--kpi-card-4-bg); }
#luyke-kpi-cards-container .kpi-card:nth-child(5) { background-color: var(--kpi-card-5-bg); }
#luyke-kpi-cards-container .kpi-card:nth-child(6) { background-color: var(--kpi-card-6-bg); }


/* --- PROGRESS BAR & MISC --- */
.progress-bar-container { overflow: hidden; }
.progress-bar { background-image: linear-gradient(45deg, rgba(255, 255, 255, .15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, .15) 50%, rgba(255, 255, 255, .15) 75%, transparent 75%, transparent); background-size: 1rem 1rem; animation: progress-bar-stripes 1s linear infinite; }
@keyframes progress-bar-stripes { from { background-position: 1rem 0; } to { background-position: 0 0; } }
#sknv-details-container .sknv-subtable-header th { font-size: 0.875rem; font-weight: 600; background-color: #f3f4f6; }
.choices__inner { min-height: 42px; }
.choices__list--multiple .choices__item { background-color: #3b82f6; border-color: #2563eb; }

/* --- TOGGLE FILTERS & HIGHLIGHTING --- */
.toggle-filters-btn { display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.5rem 1rem; border-radius: 0.5rem; background-color: #f3f4f6; color: #4b5563; font-weight: 500; font-size: 0.875rem; cursor: pointer; transition: background-color 0.2s ease-in-out; margin-bottom: 1rem; border: 1px solid #e5e7eb; }
.toggle-filters-btn:hover { background-color: #e5e7eb; }
.toggle-filters-btn .icon { width: 1rem; height: 1rem; transition: transform 0.3s ease-in-out; }
.toggle-filters-btn.active .icon { transform: rotate(180deg); }
.advanced-filters { padding: 1.25rem; border: 1px dashed #9ca3af; border-radius: 0.5rem; background-color: #f9fafb; margin-top: 0.5rem; }
.highlight-trigger { background: none; border: none; cursor: pointer; color: #6b7280; }
.highlight-trigger:hover { color: #1d4ed8; }
.highlighted-row td { animation: pulse-bg 2s infinite; }
@keyframes pulse-bg { 0% { background-color: var(--highlight-color, #ffff99); } 50% { background-color: var(--highlight-color-light, #ffffcc); } 100% { background-color: var(--highlight-color, #ffff99); } }

/* Daily goal cells */
.daily-goal-cell[contenteditable="true"] {
    outline: none;
    cursor: text;
    padding: 0.5rem 0.75rem !important;
    border-bottom: 1px solid transparent;
    transition: border-color 0.2s ease-in-out, background-color 0.2s ease-in-out;
}
.daily-goal-cell[contenteditable="true"]:hover { border-bottom-color: #9ca3af; }
.daily-goal-cell[contenteditable="true"]:focus { background-color: #eff6ff; border-bottom-color: #3b82f6; }

/* --- ADVANCED STYLES FOR SCREEN CAPTURE --- */
.capture-container {
    padding: 24px;
    background-color: #f3f4f6;
    box-sizing: border-box;
    width: fit-content;
    max-width: 1440px;
}
.capture-layout-container {
    display: flex;
    flex-direction: column;
    gap: 24px;
}
.capture-layout-container[data-capture-layout="grid"] {
    display: grid !important;
    grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
    align-items: start;
}
/* [+] NEW: Added a specific layout rule for SKNV to fix the incorrect vertical stacking. */
.capture-layout-container[data-capture-layout="sknv-custom"] {
    display: grid !important;
    grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
    grid-auto-flow: row;
    align-items: start;
}
.capture-title {
    font-size: 28px;
    font-weight: 700;
    text-align: center;
    color: #1f2937;
    margin-bottom: 24px;
    padding: 12px;
    background-color: #ffffff;
    border-radius: 0.75rem;
    box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
}
.prepare-for-capture .bg-white { 
    box-shadow: none !important; 
    border: none !important; 
}
.prepare-for-capture table {
    table-layout: fixed !important;
    width: 100% !important;
}

.prepare-for-capture td {
    font-weight: 600 !important;
}
.prepare-for-capture th {
    font-weight: 700 !important;
}

.prepare-for-capture th, 
.prepare-for-capture td {
    padding: 14px 10px !important;
    font-size: 22px !important;
    white-space: normal !important;
    word-break: break-word !important;
    vertical-align: middle !important;
    height: auto !important;
    line-height: 1.4 !important;
}

.prepare-for-capture h3,
.prepare-for-capture h4,
.department-block > h4 {
    font-size: 28px !important;
    font-weight: 700 !important;
}
.prepare-for-capture .kpi-card {
    padding: 24px !important;
}
.prepare-for-capture .kpi-card-title {
    font-size: 20px !important;
    font-weight: 700 !important;
}
.prepare-for-capture .kpi-card p[id$="-main"] {
    font-size: 48px !important;
    font-weight: 800 !important;
    line-height: 1.1 !important;
}
.prepare-for-capture .kpi-card p[id$="-sub"],
.prepare-for-capture .kpi-card p[id$="-sub1"],
.prepare-for-capture .kpi-card p[id$="-sub2"] {
    font-size: 18px !important;
    font-weight: 600 !important;
}


/* [+] NEW: Specific column widths for different tables to optimize space */
.prepare-for-capture[data-capture-columns="7"] th:nth-child(1), .prepare-for-capture[data-capture-columns="7"] td:nth-child(1) { width: 24%; }
.prepare-for-capture[data-capture-columns="7"] th:nth-child(n+2), .prepare-for-capture[data-capture-columns="7"] td:nth-child(n+2) { width: 12.6%; text-align: right; }

.prepare-for-capture[data-capture-columns="11"] th:nth-child(1), .prepare-for-capture[data-capture-columns="11"] td:nth-child(1) { width: 20%; } /* Ten NV */
.prepare-for-capture[data-capture-columns="11"] th:nth-child(4), .prepare-for-capture[data-capture-columns="11"] td:nth-child(4) { width: 9%; } /* % PK */
.prepare-for-capture[data-capture-columns="11"] th:nth-child(7), .prepare-for-capture[data-capture-columns="11"] td:nth-child(7) { width: 9%; } /* % GD */
.prepare-for-capture[data-capture-columns="11"] th:nth-child(8), .prepare-for-capture[data-capture-columns="11"] td:nth-child(8) { width: 9%; } /* % MLN */
.prepare-for-capture[data-capture-columns="11"] th:nth-child(n+2), .prepare-for-capture[data-capture-columns="11"] td:nth-child(n+2) { text-align: right; }

.prepare-for-capture[data-capture-columns="5"] th:nth-child(1), .prepare-for-capture[data-capture-columns="5"] td:nth-child(1) { width: 32%; }
.prepare-for-capture[data-capture-columns="5"] th:nth-child(n+2), .prepare-for-capture[data-capture-columns="5"] td:nth-child(n+2) { width: 17%; text-align: right; }

.prepare-for-capture[data-capture-columns="6"] th:nth-child(1), .prepare-for-capture[data-capture-columns="6"] td:nth-child(1) { width: 30%; }
.prepare-for-capture[data-capture-columns="6"] th:nth-child(n+2), .prepare-for-capture[data-capture-columns="6"] td:nth-child(n+2) { width: 14%; text-align: right; }

.prepare-for-capture[data-capture-columns="4"] th:nth-child(1), .prepare-for-capture[data-capture-columns="4"] td:nth-child(1) { width: 40%; }
.prepare-for-capture[data-capture-columns="4"] th:nth-child(n+2), .prepare-for-capture[data-capture-columns="4"] td:nth-child(n+2) { width: 20%; text-align: right; }
.prepare-for-capture[data-capture-columns="4"] td:nth-child(4) { text-align: center !important; }

.prepare-for-capture[data-capture-columns="3"] th:nth-child(1), .prepare-for-capture[data-capture-columns="3"] td:nth-child(1) { width: 50%; }
.prepare-for-capture[data-capture-columns="3"] th:nth-child(n+2), .prepare-for-capture[data-capture-columns="3"] td:nth-child(n+2) { width: 25%; text-align: right; }

